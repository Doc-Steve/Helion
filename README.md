# Helion
Ambilight clone for windows written in Rust, meant to be used with an Arduino running [LEDstream](https://github.com/adafruit/Adalight/tree/master/Arduino/LEDstream).

Using the [DXGCap](https://github.com/bryal/DXGCap) library to capture the screen in Windows, this program analyzes the image and sends resulting LED data to the Arduino.

[Test video](https://www.youtube.com/watch?v=3ZARz9ELfA4&feature=youtu.be)


# Config
Helion uses configuration generated by [HyperCon](https://github.com/tvdzwan/hyperion/wiki/configuration).
Config must be located in the current working directory, which is same as where the .exe is located when not run from command line.

Notes about config sections:

* `Device`: `Output` is serial port to use, e.g. "COM2" on windows. `Baudrate` is rate to use when sending pixel buffer to Arduino, LEDstream expects this to be 115200. `Type` is not read, but must be one where `Output` and `Baudrate` fields exist.

* `Construction`: Led placement. Everything is read.

* `Image Process`: Led capture areas. Blackborder stuff not read.

* `Frame Grabber`: **REQUIRED**. `Width` and `Height` decides to what resolution frame is resized when analyzing colors, smaller is faster. Works best if dimensions are divisors of the native resolution. If either is 0, use native resolution.
`Interval` decides frame limit. 1/interval = FPS. 20ms (50fps) is good default.

* `Smoothing`: Nothing yet!

* `Colors`: Everythign is read. If the RGB section or HSV section is left with default values, that section will be skipped for small performance gain.

There are no plans to add support for anything under the `External` tab. That stuff is really just for Raspberry Pis with XBMC and stuff.


# Building
Dependencies:
```
Helion
|-- DXGCap
|-- serial-rust
|   |-- serial-C
```

Only Windows is supported at this time, as DXGCap is Windows only and I have not yet added support for any linux screen capturing.

## Windows

1. Build DXGCap and serial-C as dlls
2. Place DXGCap.dll and serial_c.dll in project root.
3. `cargo build`
4. ???
5. Profit

Note: While static linking would've been preferred, static libs, Windows, Rust, and x64 does not go nicely together. If you do succed building using static libs, please tell me how you did it!